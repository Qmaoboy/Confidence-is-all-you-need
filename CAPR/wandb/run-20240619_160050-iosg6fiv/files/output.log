/root/miniconda3/envs/pace/lib/python3.12/site-packages/trl/trainer/ppo_trainer.py:266: UserWarning: No dataset is provided. Make sure to set config.batch_size to the correct value before training.
  warnings.warn(
epoch:   0%|                                                                                                                                           | 0/15 [00:00<?, ?it/s]You're using a LlamaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
  0%|                                                                                                                                   | 0/433 [00:00<?, ?it/s, get Response]

  warnings.warn(                                                                                                                          | 0/433 [00:17<?, ?it/s, get Reward]






Epoch 0,16,grad step:512:   0%|▍                                                                                                | 2/433 [00:55<2:13:58, 18.65s/it, get Reward]





















Epoch 0,72,grad step:512:   2%|██                                                                                               | 9/433 [03:17<2:23:13, 20.27s/it, get Reward]



Epoch 0,80,grad step:512:   2%|██▏                                                                                             | 10/433 [03:37<2:20:13, 19.89s/it, get Reward]






Epoch 0,96,grad step:512:   3%|██▋                                                                                             | 12/433 [04:15<2:18:56, 19.80s/it, get Reward]



Epoch 0,104,grad step:512:   3%|██▊                                                                                            | 13/433 [04:33<2:15:52, 19.41s/it, get Reward]

































Epoch 0,192,grad step:512:   6%|█████▎                                                                                         | 24/433 [09:17<2:34:04, 22.60s/it, get Reward]















Epoch 0,232,grad step:512:   7%|██████▎                                                                                        | 29/433 [10:53<2:13:14, 19.79s/it, get Reward]



Epoch 0,240,grad step:512:   7%|██████▌                                                                                        | 30/433 [11:13<2:12:01, 19.66s/it, get Reward]



Epoch 0,248,grad step:512:   7%|██████▊                                                                                        | 31/433 [11:33<2:12:39, 19.80s/it, get Reward]



Epoch 0,256,grad step:512:   7%|███████                                                                                        | 32/433 [11:53<2:12:24, 19.81s/it, get Reward]
























Epoch 0,320,grad step:512:   9%|████████▊                                                                                      | 40/433 [14:29<2:09:18, 19.74s/it, get Reward]






Epoch 0,336,grad step:512:  10%|█████████▏                                                                                     | 42/433 [15:09<2:06:25, 19.40s/it, get Reward]



Epoch 0,344,grad step:512:  10%|█████████▍                                                                                     | 43/433 [15:29<2:08:27, 19.76s/it, get Reward]










































Epoch 0,456,grad step:512:  13%|████████████▌                                                                                  | 57/433 [20:11<2:04:47, 19.91s/it, get Reward]



Epoch 0,464,grad step:512:  13%|████████████▋                                                                                  | 58/433 [20:30<2:03:35, 19.77s/it, get Reward]















Epoch 0,504,grad step:512:  15%|█████████████▊                                                                                 | 63/433 [22:16<2:09:10, 20.95s/it, get Reward]


  data_value=list(map(torch.tensor,data_value))                                                                                | 63/433 [22:18<2:09:10, 20.95s/it, get Reward]
Training:0/15,
Accuracy 0.1603
ECE 0.7050
Reward 0.1603


Epoch 0,512,grad step:512:  15%|█████████████▋                                                                               | 64/433 [34:13<23:37:36, 230.50s/it, get Reward]









Epoch 0,24,grad step:512:  15%|██████████████▊                                                                                 | 67/433 [35:11<9:20:58, 91.96s/it, get Reward]






Epoch 0,40,grad step:512:  16%|███████████████▎                                                                                | 69/433 [35:50<5:31:22, 54.62s/it, get Reward]

































Epoch 0,128,grad step:512:  18%|█████████████████▌                                                                             | 80/433 [39:36<2:04:49, 21.22s/it, get Reward]












Epoch 0,160,grad step:512:  19%|██████████████████▍                                                                            | 84/433 [41:00<2:01:10, 20.83s/it, get Reward]






Epoch 0,176,grad step:512:  20%|██████████████████▊                                                                            | 86/433 [41:39<1:59:30, 20.67s/it, get Reward]






























Epoch 0,256,grad step:512:  22%|█████████████████████                                                                          | 96/433 [44:57<1:52:44, 20.07s/it, get Reward]



Epoch 0,264,grad step:512:  22%|█████████████████████▎                                                                         | 97/433 [45:18<1:53:30, 20.27s/it, get Reward]



Epoch 0,272,grad step:512:  23%|█████████████████████▌                                                                         | 98/433 [45:36<1:52:13, 20.10s/it, get Reward]



Epoch 0,280,grad step:512:  23%|█████████████████████▋                                                                         | 99/433 [45:56<1:48:48, 19.55s/it, get Reward]






Epoch 0,296,grad step:512:  23%|█████████████████████▉                                                                        | 101/433 [46:36<1:48:43, 19.65s/it, get Reward]






Epoch 0,312,grad step:512:  24%|██████████████████████▎                                                                       | 103/433 [47:16<1:51:02, 20.19s/it, get Reward]






Epoch 0,328,grad step:512:  24%|██████████████████████▊                                                                       | 105/433 [47:56<1:50:11, 20.16s/it, get Reward]
























Epoch 0,392,grad step:512:  26%|████████████████████████▌                                                                     | 113/433 [50:40<1:51:14, 20.86s/it, get Reward]






Epoch 0,408,grad step:512:  27%|████████████████████████▉                                                                     | 115/433 [51:22<1:49:50, 20.72s/it, get Reward]












Epoch 0,440,grad step:512:  27%|█████████████████████████▊                                                                    | 119/433 [53:28<2:57:52, 33.99s/it, get Reward]
























Epoch 0,504,grad step:512:  29%|███████████████████████████▌                                                                  | 127/433 [56:14<1:51:36, 21.88s/it, get Reward]

7it [00:00, 16.71it/s, Hit Rate 0.88]
Training:0/15,
Accuracy 0.2326
ECE 0.6387








































































Epoch 0,184,grad step:512:  35%|████████████████████████████████                                                            | 151/433 [1:17:19<1:41:34, 21.61s/it, get Reward]






























Epoch 0,264,grad step:512:  37%|██████████████████████████████████▏                                                         | 161/433 [1:24:03<1:49:16, 24.11s/it, get Reward]



Epoch 0,272,grad step:512:  37%|██████████████████████████████████▍                                                         | 162/433 [1:24:21<1:44:30, 23.14s/it, get Reward]



Epoch 0,280,grad step:512:  38%|██████████████████████████████████▋                                                         | 163/433 [1:24:41<1:37:18, 21.62s/it, get Reward]


















Epoch 0,328,grad step:512:  39%|███████████████████████████████████▉                                                        | 169/433 [1:26:47<1:32:50, 21.10s/it, get Reward]






























Epoch 0,408,grad step:512:  41%|██████████████████████████████████████                                                      | 179/433 [1:30:23<1:35:23, 22.54s/it, get Reward]






Epoch 0,424,grad step:512:  42%|██████████████████████████████████████▍                                                     | 181/433 [1:31:03<1:31:01, 21.67s/it, get Reward]






Epoch 0,440,grad step:512:  42%|██████████████████████████████████████▉                                                     | 183/433 [1:31:43<1:24:30, 20.28s/it, get Reward]


















Epoch 0,488,grad step:512:  44%|████████████████████████████████████████▏                                                   | 189/433 [1:33:50<1:25:54, 21.13s/it, get Reward]








Epoch 0,512,grad step:512:  44%|███████████████████████████████████████                                                 | 192/433 [1:46:13<15:25:37, 230.44s/it, get Response]
Training:0/15,
Accuracy 0.2193
ECE 0.5850

















Epoch 0,40,grad step:512:  45%|██████████████████████████████████████████▎                                                  | 197/433 [1:48:11<3:38:00, 55.42s/it, get Reward]



Epoch 0,48,grad step:512:  46%|██████████████████████████████████████████▌                                                  | 198/433 [1:48:30<2:55:49, 44.89s/it, get Reward]






Epoch 0,64,grad step:512:  46%|██████████████████████████████████████████▉                                                  | 200/433 [1:49:11<2:05:59, 32.44s/it, get Reward]















Epoch 0,104,grad step:512:  47%|███████████████████████████████████████████▌                                                | 205/433 [1:50:53<1:25:35, 22.53s/it, get Reward]





















Epoch 0,160,grad step:512:  49%|█████████████████████████████████████████████                                               | 212/433 [1:53:13<1:13:28, 19.95s/it, get Reward]












Epoch 0,192,grad step:512:  50%|█████████████████████████████████████████████▉                                              | 216/433 [1:54:33<1:13:12, 20.24s/it, get Reward]









Epoch 0,216,grad step:512:  51%|██████████████████████████████████████████████▌                                             | 219/433 [1:55:31<1:10:20, 19.72s/it, get Reward]





















Epoch 0,272,grad step:512:  52%|████████████████████████████████████████████████                                            | 226/433 [1:57:49<1:11:01, 20.59s/it, get Reward]












Epoch 0,304,grad step:512:  53%|████████████████████████████████████████████████▊                                           | 230/433 [1:59:09<1:06:39, 19.70s/it, get Reward]

























































Epoch 0,456,grad step:512:  58%|████████████████████████████████████████████████████▉                                       | 249/433 [2:06:51<1:08:42, 22.40s/it, get Reward]



















Epoch 0,512,grad step:512:  59%|██████████████████████████████████████████████████████▏                                     | 255/433 [2:09:01<1:02:26, 21.05s/it, get Reward]
Training:0/15,
Accuracy 0.1886
ECE 0.6226









Epoch 0,16,grad step:512:  60%|██████████████████████████████████████████████████████▊                                     | 258/433 [2:21:32<5:58:04, 122.77s/it, get Reward]









Epoch 0,40,grad step:512:  60%|████████████████████████████████████████████████████████                                     | 261/433 [2:22:38<2:40:03, 55.83s/it, get Reward]





















Epoch 0,96,grad step:512:  62%|█████████████████████████████████████████████████████████▌                                   | 268/433 [2:24:55<1:02:11, 22.62s/it, get Reward]












Epoch 0,128,grad step:512:  63%|███████████████████████████████████████████████████████████                                   | 272/433 [2:26:18<55:17, 20.60s/it, get Reward]



Epoch 0,136,grad step:512:  63%|███████████████████████████████████████████████████████████▎                                  | 273/433 [2:26:38<55:47, 20.92s/it, get Reward]
























Epoch 0,200,grad step:512:  65%|█████████████████████████████████████████████████████████████                                 | 281/433 [2:29:14<48:35, 19.18s/it, get Reward]

































Epoch 0,288,grad step:512:  67%|███████████████████████████████████████████████████████████████▍                              | 292/433 [2:33:00<46:45, 19.90s/it, get Reward]















Epoch 0,328,grad step:512:  69%|████████████████████████████████████████████████████████████████▍                             | 297/433 [2:34:46<47:46, 21.08s/it, get Reward]






Epoch 0,344,grad step:512:  69%|████████████████████████████████████████████████████████████████▉                             | 299/433 [2:35:26<46:44, 20.93s/it, get Reward]






























Epoch 0,424,grad step:512:  71%|███████████████████████████████████████████████████████████████████                           | 309/433 [2:38:42<39:27, 19.09s/it, get Reward]






Epoch 0,440,grad step:512:  72%|███████████████████████████████████████████████████████████████████▌                          | 311/433 [2:39:22<39:07, 19.24s/it, get Reward]


























Epoch 0,512,grad step:512:  74%|█████████████████████████████████████████████████████████████████▊                       | 320/433 [2:54:49<7:46:33, 247.73s/it, get Response]
Training:0/15,
Accuracy 0.2170
ECE 0.6380




















Epoch 0,48,grad step:512:  75%|██████████████████████████████████████████████████████████████████████                       | 326/433 [2:57:11<1:26:03, 48.26s/it, get Reward]












Epoch 0,80,grad step:512:  76%|████████████████████████████████████████████████████████████████████████▍                      | 330/433 [2:58:29<45:06, 26.28s/it, get Reward]












Epoch 0,112,grad step:512:  77%|████████████████████████████████████████████████████████████████████████▌                     | 334/433 [2:59:47<34:41, 21.02s/it, get Reward]



Epoch 0,120,grad step:512:  77%|████████████████████████████████████████████████████████████████████████▋                     | 335/433 [3:00:07<34:07, 20.90s/it, get Reward]






















































Epoch 0,264,grad step:512:  82%|████████████████████████████████████████████████████████████████████████████▋                 | 353/433 [3:06:03<26:48, 20.10s/it, get Reward]






Epoch 0,280,grad step:512:  82%|█████████████████████████████████████████████████████████████████████████████                 | 355/433 [3:06:43<26:47, 20.61s/it, get Reward]

































Epoch 0,368,grad step:512:  85%|███████████████████████████████████████████████████████████████████████████████▍              | 366/433 [3:10:23<23:28, 21.03s/it, get Reward]






Epoch 0,384,grad step:512:  85%|███████████████████████████████████████████████████████████████████████████████▉              | 368/433 [3:11:07<22:54, 21.15s/it, get Reward]












Epoch 0,416,grad step:512:  86%|████████████████████████████████████████████████████████████████████████████████▊             | 372/433 [3:12:32<20:31, 20.18s/it, get Reward]
























Epoch 0,480,grad step:512:  88%|██████████████████████████████████████████████████████████████████████████████████▍           | 380/433 [3:17:11<26:04, 29.51s/it, get Reward]










Epoch 0,512,grad step:512:  88%|███████████████████████████████████████████████████████████████████████████████████▏          | 383/433 [3:18:13<19:40, 23.62s/it, get Reward]
Training:0/15,
Accuracy 0.2064
ECE 0.6500









Epoch 0,16,grad step:512:  89%|██████████████████████████████████████████████████████████████████████████████████          | 386/433 [3:30:41<1:36:02, 122.61s/it, get Reward]



Epoch 0,24,grad step:512:  89%|███████████████████████████████████████████████████████████████████████████████████          | 387/433 [3:30:57<1:10:29, 91.94s/it, get Reward]






Epoch 0,40,grad step:512:  90%|█████████████████████████████████████████████████████████████████████████████████████▎         | 389/433 [3:31:41<40:15, 54.89s/it, get Reward]



























Epoch 0,112,grad step:512:  92%|██████████████████████████████████████████████████████████████████████████████████████▍       | 398/433 [3:34:35<12:15, 21.03s/it, get Reward]

































Epoch 0,200,grad step:512:  94%|████████████████████████████████████████████████████████████████████████████████████████▊     | 409/433 [3:38:13<07:49, 19.55s/it, get Reward]


















Epoch 0,248,grad step:512:  96%|██████████████████████████████████████████████████████████████████████████████████████████    | 415/433 [3:40:17<06:18, 21.05s/it, get Reward]



Epoch 0,256,grad step:512:  96%|██████████████████████████████████████████████████████████████████████████████████████████▎   | 416/433 [3:40:37<05:46, 20.40s/it, get Reward]









Epoch 0,280,grad step:512:  97%|██████████████████████████████████████████████████████████████████████████████████████████▉   | 419/433 [3:41:39<05:04, 21.75s/it, get Reward]



Epoch 0,288,grad step:512:  97%|███████████████████████████████████████████████████████████████████████████████████████████▏  | 420/433 [3:41:58<04:22, 20.17s/it, get Reward]















Epoch 0,328,grad step:512:  98%|████████████████████████████████████████████████████████████████████████████████████████████▎ | 425/433 [3:43:34<02:35, 19.42s/it, get Reward]









Epoch 0,352,grad step:512:  99%|████████████████████████████████████████████████████████████████████████████████████████████▉ | 428/433 [3:44:30<01:36, 19.22s/it, get Reward]












Epoch 0,384,grad step:512: 100%|█████████████████████████████████████████████████████████████████████████████████████████████▊| 432/433 [3:45:44<00:18, 18.46s/it, get Reward]
Traceback (most recent call last):
  File "/home/qmaothesis/CAPR/TRL_training.py", line 253, in <module>
  File "/home/qmaothesis/CAPR/TRL_training.py", line 246, in main
    }
  File "/home/qmaothesis/CAPR/TRL_training.py", line 126, in trainer
    response_tensors_list=[]
TypeError: unsupported format string passed to numpy.ndarray.__format__